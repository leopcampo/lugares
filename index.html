<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Organizador de Mesas – Casamento (Drag & Drop)</title>
  <style>
    :root{
      --bg:#0f172a;
      --panel:#111827;
      --muted:#1f2937;
      --card:#0b1225;
      --accent:#22d3ee;
      --accent-2:#38bdf8;
      --text:#e5e7eb;
      --text-dim:#9ca3af;
      --ok:#10b981;
      --warn:#f59e0b;
      --danger:#ef4444;
      --shadow:0 10px 25px rgba(0,0,0,.35);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 100% 0, #0b1534, transparent), var(--bg);
      color:var(--text);
    }

    header{
      display:flex; gap:12px; align-items:center; justify-content:space-between;
      padding:16px clamp(12px, 3vw, 28px);
      position:sticky; top:0; z-index:10; backdrop-filter: blur(8px);
      background:linear-gradient(180deg, rgba(15,23,42,.92), rgba(15,23,42,.8));
      border-bottom:1px solid rgba(148,163,184,.12);
    }
    .brand{display:flex; gap:12px; align-items:center}
    .logo{width:36px; height:36px; border-radius:12px; background:linear-gradient(145deg, var(--accent), var(--accent-2)); box-shadow: var(--shadow)}
    h1{font-size: clamp(18px, 2.6vw, 24px); margin:0; letter-spacing:.5px}
    .toolbar{display:flex; flex-wrap:wrap; gap:8px}
    .btn{
      border:1px solid rgba(148,163,184,.18);
      background:linear-gradient(180deg, #0d142c, #0b1225);
      color:var(--text);
      padding:10px 14px; border-radius:12px; cursor:pointer; box-shadow: var(--shadow);
      transition:.2s transform, .2s background, .2s border-color, .2s opacity;
      font-weight:600; font-size:14px;
    }
    .btn:hover{transform:translateY(-1px); border-color: rgba(148,163,184,.35)}
    .btn:active{transform:translateY(0)}
    .btn.primary{background:linear-gradient(180deg, #0d1b3d, #0b1534); border-color: rgba(56,189,248,.55)}
    .btn.ok{border-color: rgba(16,185,129,.5)}
    .btn.warn{border-color: rgba(245,158,11,.5)}
    .btn.danger{border-color: rgba(239,68,68,.5)}
    .btn.small{padding:6px 10px; font-size:12px}

    .wrap{
      display:grid; grid-template-columns: 320px 1fr; gap:16px; padding:16px; max-width: 1400px; margin:0 auto;
    }
    @media (max-width: 900px){
      .wrap{grid-template-columns: 1fr;}
    }

    .panel{
      background:linear-gradient(180deg, var(--panel), #0d162f);
      border:1px solid rgba(148,163,184,.12);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .guests{display:flex; flex-direction:column; min-height:300px}
    .guests header{position:unset; background:none; border:0; padding:16px}
    .guest-inputs{display:flex; gap:8px; flex-wrap:wrap}
    .input{flex:1; min-width:140px; background:#0a1226; color:var(--text); border:1px solid rgba(148,163,184,.2); border-radius:10px; padding:10px 12px}
    .list{padding:12px 14px 18px; display:grid; grid-template-columns: repeat(auto-fill, minmax(130px,1fr)); gap:10px}
    .chip{
      display:flex; align-items:center; justify-content:space-between; gap:8px;
      padding:8px 10px; border-radius:12px; background:linear-gradient(180deg, #0f1a35, #0b142c);
      border:1px solid rgba(148,163,184,.16); cursor:grab; user-select:none;
    }
    .chip[draggable="true"]{touch-action:none}
    .chip .name{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
    .chip .x{opacity:.8; cursor:pointer}

    .tables{padding:14px; display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:14px}
    .table{
      background:linear-gradient(180deg, #0c142b, #0a1124);
      border:1px solid rgba(148,163,184,.16);
      padding:12px; border-radius:18px; display:flex; flex-direction:column; gap:10px; position:relative;
      min-height:220px;
    }
    .table-title{display:flex; align-items:center; gap:8px}
    .table-title input{flex:1; background:transparent; border:1px dashed rgba(148,163,184,.25); color:var(--text); padding:8px 10px; border-radius:10px; font-weight:600}
    .seat-grid{display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:10px; margin-top:8px}
    .seat{
      height:56px; border-radius:14px; display:flex; align-items:center; justify-content:center; text-align:center; padding:6px;
      border:1px dashed rgba(148,163,184,.28);
      background:linear-gradient(180deg, #0b1327, #0a1122);
      position:relative;
    }
    .seat.occupied{border-style:solid; border-color: rgba(56,189,248,.6);}
    .seat .seat-label{position:absolute; top:6px; left:8px; font-size:11px; color:var(--text-dim)}
    .seat .guest-name{font-weight:600; font-size:13px; line-height:1.1; overflow:hidden; text-overflow:ellipsis}

    .table-actions{display:flex; gap:6px; flex-wrap:wrap}
    .muted{color:var(--text-dim); font-size:12px}

    .drop-hover{outline:2px dashed var(--accent); outline-offset:2px}

    footer{padding:12px; text-align:center; color:var(--text-dim); font-size:12px}

    @media print{
      header, .guests, .toolbar .btn:not(.print-only){display:none !important}
      body{background:white; color:black}
      .wrap{display:block; padding:0}
      .tables{display:grid; grid-template-columns: repeat(2, 1fr)}
      .table{break-inside: avoid; border:1px solid #000}
      .seat{border:1px solid #000}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <h1>Organizador de Mesas – Casamento</h1>
    </div>
    <div class="toolbar">
      <button class="btn primary" id="addTableBtn">+ Adicionar mesa</button>
      <button class="btn ok" id="autoSeatBtn">Distribuir automático</button>
      <button class="btn" id="saveBtn">Salvar</button>
      <button class="btn" id="loadBtn">Carregar</button>
      <button class="btn" id="exportBtn">Exportar JSON</button>
      <button class="btn" id="importBtn">Importar JSON</button>
      <button class="btn warn print-only" onclick="window.print()">Imprimir</button>
      <button class="btn danger" id="clearAllBtn">Zerar tudo</button>
    </div>
  </header>

  <main class="wrap">
    <section class="panel guests" aria-label="Convidados">
      <header>
        <h2 style="margin:0 0 8px 0; font-size:18px">Convidados</h2>
        <div class="guest-inputs">
          <input id="guestName" class="input" type="text" placeholder="Nome do convidado" />
          <button id="addGuestBtn" class="btn ok">Adicionar</button>
          <button id="bulkBtn" class="btn">Adicionar em lote</button>
		  <input id="searchGuest" class="input" type="text" placeholder="Pesquisar convidado..." style="margin-top:10px;width:100%" />
        </div>
        
        
      </header>
      <div id="guestList" class="list" aria-live="polite"></div>
    </section>

    <section class="panel" aria-label="Mesas">
      <div class="tables" id="tables"></div>
    </section>
  </main>

  <footer>
    Feito com ❤️. Te amo mozão.
  </footer>

  <input type="file" id="fileInput" accept="application/json" hidden />

  <script>
  const state = {guests: [], tables: [], seq: 1}
  const newId = ()=>'id_'+(state.seq++)+'_'+Math.random().toString(36).slice(2,8)

  function addGuest(name){
    name=(name||'').trim(); if(!name) return
    const g={id:newId(),name}
    state.guests.push(g)
    renderGuests()
  }
  function removeGuest(id){
    for(const t of state.tables){t.seats=t.seats.map(s=>s===id?null:s)}
    state.guests=state.guests.filter(g=>g.id!==id)
    renderAll()
  }
  function getUnseatedGuests(){
    const seated=new Set()
    for(const t of state.tables){for(const s of t.seats){if(s) seated.add(s)}}
    return state.guests.filter(g=>!seated.has(g.id))
  }
  function renderGuests(){
    const list=document.getElementById('guestList'); list.innerHTML=''
    const unseated=getUnseatedGuests()
    const term=document.getElementById('searchGuest').value.toLowerCase()
    for(const g of unseated){
      if(term && !g.name.toLowerCase().includes(term)) continue
      const chip=document.createElement('div')
      chip.className='chip'; chip.draggable=true; chip.dataset.guestId=g.id
      chip.innerHTML=`<span class="name">${g.name}</span><span class="x">✕</span>`
      chip.addEventListener('dragstart', onGuestDragStart)
      chip.querySelector('.x').onclick=()=>removeGuest(g.id)
      list.appendChild(chip)
    }
  }
  function renderTables(){
    const wrap=document.getElementById('tables'); wrap.innerHTML=''
    state.tables.forEach((t)=>{
      const card=document.createElement('div'); card.className='table'
      const title=document.createElement('div'); title.className='table-title'
      title.innerHTML=`<input value="${t.name}" />`
      const grid=document.createElement('div'); grid.className='seat-grid'
      t.seats.forEach((guestId,si)=>{
        const seat=document.createElement('div'); seat.className='seat'+(guestId?' occupied':'')
        seat.dataset.tableId=t.id; seat.dataset.index=si
        seat.textContent=guestId?guestName(guestId):'Vazio'
        seat.addEventListener('dragover',e=>{e.preventDefault(); seat.classList.add('drop-hover')})
        seat.addEventListener('dragleave',()=>seat.classList.remove('drop-hover'))
        seat.addEventListener('drop',e=>onSeatDrop(e,seat))
        grid.appendChild(seat)
      })
      card.appendChild(title); card.appendChild(grid); wrap.appendChild(card)
    })
  }
  function guestName(id){const g=state.guests.find(g=>g.id===id);return g?g.name:'(Removido)'}
  function onGuestDragStart(e){e.dataTransfer.setData('text/plain',e.currentTarget.dataset.guestId)}
  function onSeatDrop(e,seat){e.preventDefault(); seat.classList.remove('drop-hover')
    const guestId=e.dataTransfer.getData('text/plain')
    const t=state.tables.find(t=>t.id===seat.dataset.tableId)
    const idx=Number(seat.dataset.index)
    for(const tb of state.tables){for(let i=0;i<tb.seats.length;i++){if(tb.seats[i]===guestId) tb.seats[i]=null}}
    t.seats[idx]=guestId; renderAll()
  }
  function renderAll(){renderGuests();renderTables()}

  document.getElementById('addGuestBtn').onclick=()=>{addGuest(document.getElementById('guestName').value);document.getElementById('guestName').value=''}
  document.getElementById('searchGuest').addEventListener('input',renderGuests)

  ;(function init(){state.tables.push({id:newId(),name:'Mesa 1',seats:Array(8).fill(null)}); renderAll()})()
  </script>
</body>
</html>
